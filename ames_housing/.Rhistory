knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(lubridate)
library(tidyverse)
housing = read.csv('Ames_HousePrice.csv', header = TRUE)
real_estate = read.csv('data/Ames_Real_Estate_Data.csv')
View(housing)
View(real_estate)
housing.model = lm(salesPrice ~ ., data = housing)
housing.model = lm(SalePrice ~ ., data = housing)
summary(housing.model)
housing.model2 = lm(SalePrice ~ GrLivArea + LotArea + Neighborhood + Condition1 + Condition2 + OverallQual + OverallCond + YearBuilt + RoofMatlWdShngl + MasVnrType + MasVnrArea + ExterQual + BsmtFinSF2 + BsmtUnfSF + BedroomAbvGr + KitchenQual + Fireplaces + FireplaceQu, data = housing)
housing.model2 = lm(SalePrice ~ GrLivArea + LotArea + Neighborhood + Condition1 + Condition2 + OverallQual + OverallCond + YearBuilt + RoofMatl + MasVnrType + MasVnrArea + ExterQual + BsmtFinSF2 + BsmtUnfSF + BedroomAbvGr + KitchenQual + Fireplaces + FireplaceQu, data = housing)
summary(housing.model2)
plot(hosing.model2)
plot(housing.model2)
summary(housing.model3)
housing.model3 = lm(log(SalePrice) ~ GrLivArea + LotArea + Neighborhood + Condition1 + Condition2 + OverallQual + OverallCond + YearBuilt + RoofMatl + MasVnrType + MasVnrArea + ExterQual + BsmtFinSF2 + BsmtUnfSF + BedroomAbvGr + KitchenQual + Fireplaces + FireplaceQu, data = housing)
summary(housing.model3)
plot(housing.model3)
housing.model3 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + Neighborhood + Condition1 + Condition2 + OverallQual + OverallCond + YearBuilt + RoofMatl + MasVnrType + log(MasVnrArea) + ExterQual + BsmtFinSF2 + BsmtUnfSF + BedroomAbvGr + KitchenQual + Fireplaces + FireplaceQu, data = housing)
housing.model3 = lm(log(SalePrice) ~ log(GrLivArea, na.rm = TRUE) + log(LotArea, na.rm = TRUE) + Neighborhood + Condition1 + Condition2 + OverallQual + OverallCond + YearBuilt + RoofMatl + MasVnrType + log(MasVnrArea, na.rm = TRUE) + ExterQual + BsmtFinSF2 + BsmtUnfSF + BedroomAbvGr + KitchenQual + Fireplaces + FireplaceQu, data = housing)
housing.model4 = lm(SalePrice ~ GrLivArea + LotArea + MasVnrArea)
housing.model4 = lm(SalePrice ~ GrLivArea + LotArea + MasVnrArea, data = housing)
summary(housing.model4)
plot(housing.model4)
housing.model4 = lm(log(SalePrice) ~ GrLivArea + LotArea + MasVnrArea, data = housing)
summary(housing.model4)
plot(housing.model4)
housing.model4 = lm(log(SalePrice) ~ log(GrLivArea) + LotArea + MasVnrArea, data = housing)
summary(housing.model4)
plot(housing.model4)
summary(housing)
housing %>%
filter(is.na(MasVnrArea))
summary(housing)
housing %>%
select(SalePrice, GrLivArea, LotArea, MasVnrArea) %>%
filter(is.na(MasVnrArea))
summary(housing)
housing %>%
select(SalePrice, GrLivArea, LotArea, MasVnrArea, YearBuilt) %>%
filter(is.na(MasVnrArea))
housing2 = housing %>%
filter(is.na(MasVnrArea) != 0)
housing2 = housing %>%
filter(is.na(MasVnrArea) != 1)
housin2g %>%
select(SalePrice, GrLivArea, LotArea, MasVnrArea, YearBuilt) %>%
filter(is.na(MasVnrArea))
housing2 %>%
select(SalePrice, GrLivArea, LotArea, MasVnrArea, YearBuilt) %>%
filter(is.na(MasVnrArea))
housing2 = housing %>%
filter(is.na(MasVnrArea) != 1)
housing.model5 = lm(log(SalePrice) ~ log(GrLivArea) + LotArea + MasVnrArea, data = housing2)
summary(housing.model5)
plot(housing.model5)
housing2 = housing %>%
filter(is.na(MasVnrArea) != 1)
housing.model5 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + log(MasVnrArea), data = housing2)
housing.model5 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea, data = housing2)
summary(housing.model5)
plot(housing.model5)
housing2 = housing %>%
filter(is.na(MasVnrArea) != 1)
housing.model5 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea, data = housing2)
summary(housing.model5)
plot(housing.model5)
vif(housing.model5)
library(caret)
vif(housing.model5)
library(car)
vif(housing.model5)
housing2 = housing %>%
filter(is.na(MasVnrArea) != 1) %>%
mutate(MasVnrArea2 = case_when(
MasVnrArea == 0 ~ 0,
MasVnrArea != 0 ~ 1,
))
housing.model5 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2, data = housing2)
summary(housing.model5)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + TotalBsmtSF, data = housing2)
summary(housing.model6)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF), data = housing2)
summary(housing2)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) == 0)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF), data = housing3)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) == 0)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF), data = housing3)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1 )
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1 )
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF), data = housing3)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1 )
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + TotalBsmtSF, data = housing3)
summary(housing.model6)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1, TotalBsmtSF == 0)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF), data = housing3)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1, TotalBsmtSF != 0)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF), data = housing3)
summary(housing.model6)
plot(housing.model6)
log(0.0001)
log(0.1)
basement.model = lm(SalePrice ~ TotalBsmtSF, data = housing2)
plot(basement.model)
# Filter out 0 values out
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1, TotalBsmtSF != 0)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1), data = housing3)
summary(housing.model6)
plot(housing.model6)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1), data = housing2)
summary(housing.model6)
plot(housing.model6)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1), data = housing3)
# Filter out 0 values out
# log(x +1)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1), data = housing3)
summary(housing.model6)
plot(housing.model6)
vif(housing.model6)
# Filter out 0 values out
# log(x +1)
housing3 = housing2 %>%
filter(is.na(TotalBsmtSF) != 1)
housing.model6 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1), data = housing3)
summary(housing.model6)
plot(housing.model6)
vif(housing.model6)
housing.model7 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea),  data = housing3)
summary(housing3)
housing4 = housing3 %>%
mutate(GarageArea2 = ifelse(is.na(GarageArea), 0, GarageArea))
housing.model7 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2),  data = housing4)
housing.model7 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1),  data = housing4)
plot(housing.model7)
summary(housing.model7)
vif(housing.model7)
housing5 = housing4 %>%
mutate(PoolArea2 = ifelse(is.na(PoolArea), 0, PoolArea))
housing.model8 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + log(PoolArea + 1),  data = housing5)
summary(housing.model8)
vif(housing.model8)
plot(housing.model8)
vif(housing.model8)
summary(housing.model7)
summary(housing.model8)
housing6 = housing4 %>%
mutate(PoolArea2 = ifelse(is.na(PoolArea), 0, 1))
housing.model9 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + PoolArea,  data = housing6)
summary(housing.model9)
vif(housing.model9)
plot(housing.model9)
pool.model = lm(SalePrice ~ PoolArea, data = housing)
summary(pool.model)
year.model = lm(SalePrice ~ YearBuilt + YearRemodAdd, data = housing4)
summary(year.model)
vif(year.model)
summary(housing4)
summary(year.model)
summary(housing.model10)
housing.model10 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd,  data = housing4)
summary(housing.model10)
plot(housing.model10)
sold.model = lm(SalePrice ~ MoSold + YrSold, data = housing4)
summary(sold.model)
plot(sold.model)
housing.model11 = lm(SalePrice ~ OverallQual + OverallCond, housing4)
summary(housing.model11)
plot(housing.model11)
quality.model = lm(SalePrice ~ OverallQual + OverallCond, housing4)
summary(quality.model)
plot(quality.model)
summary(housing.model10)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message=FALSE)
AIC(model.restaurants_fd,
model.restaurants_fdl,
model.restaurants)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message=FALSE)
install.packages('Sleuth2')
library(Sleuth2)
case2002 = case2002
plot(case2002[, 5:7], col = case2002$LC)
logit.overall = glm(LC ~ FM + SS + BK + AG + YR + CD,
family = "binomial",
data = case2002)
summary(logit.overall)
logit.overall = glm(LC ~ FM + SS + BK + AG + YR + CD,
family = "binomial",
data = case2002)
summary(logit.overall)
logit.no_bk = glm(LC ~ FM + SS + AG + YR + CD,
family = "binomial",
data = case2002)
summary(logit.no_bk)
anova(logit.overall, logit.no_bk, test = 'Chisq')
anova(housing.model7, housing.model10, test = 'Chisq')
anova(housing.model10, housing.model7, test = 'Chisq')
housing.model11 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + OverallCond,  data = housing4)
summary(housing.model11)
anova(housing.model11, housing.model10, test = 'Chisq')
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log(1stFlrSF) + log(2ndFlrSF),  data = housing4)
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log('1stFlrSF') + log('2ndFlrSF'),  data = housing4)
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log(1stFlrSF) + log(2ndFlrSF),  data = housing4)
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log(X1stFlrSF) + log(X2ndFlrSF),  data = housing4)
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log(X1stFlrSF),  data = housing4)
housing6 = housing4 %>%
mutate(X2ndFlrSF = ifelse(is.na(X2ndFlrSF), 0, X2ndFlrSF))
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log(X1stFlrSF) + log(X2ndFlrSF),  data = housing6)
housing.model11 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + OverallCond,  data = housing4)
summary(housing.model11)
housing6 = housing4 %>%
mutate(X2ndFlrSF = ifelse(is.na(X2ndFlrSF), 0, X2ndFlrSF))
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log(X1stFlrSF) + log(X2ndFlrSF),  data = housing6)
housing.model12 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + log(X1stFlrSF) + log(X2ndFlrSF + 1),  data = housing6)
summary(housing.model12)
plot(housing.model12)
vif(housing.model12)
new.model = lm(SalePrice ~ GrLivArea + TotRmsAbvGrd, data = housing4)
summary(new.model)
plot(new.model)
vif(new.model)
summary(new.model)
vif(new.model)
summary(new.model)
housing4 %>%
mutate(HalfBath2 = case_when(
HalfBath = 1 ~ 0.5,
HalfBath = 0 ~ 0
)) %>%
mutate(BsmtHalfBath2 = case_when(
BsmtHalfBath = 1 ~ 0.5,
BsmtHalfBath = 0 ~ 0
))
housing5 = housing4 %>%
mutate(HalfBath2 = case_when(
HalfBath == 1 ~ 0.5,
HalfBath == 0 ~ 0
)) %>%
mutate(BsmtHalfBath2 = case_when(
BsmtHalfBath == 1 ~ 0.5,
BsmtHalfBath == 0 ~ 0
))
housing6 = housing5 %>%
mutate(total_room = TotRmsAbvGrd + BsmtHalfBath2 + HalfBath2 + FullBath + BsmtFullBath)
housing.model13 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + total_room, data = housing6)
sunmmary(housing.model13)
summary(housing.model13)
vif(housing.model13)
summary(housing.model13)
housing.model13 = lm(log(SalePrice) ~ log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + total_room, data = housing6)
summary(housing.model13)
summary(housing.model13)
# Model with GrLivArea
housing.model13 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + total_room, data = housing6)
summary(housing.model13)
# Model with total_room
housing.model14 = lm(log(SalePrice) ~ log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + total_room, data = housing6)
summary(housing.model14)
vif(housing.model14)
housing7 = housing5 %>%
mutate(num_bathroom = BsmtHalfBath2 + HalfBath2 + FullBath + BsmtFullBath)
housing.model15 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + total_room, data = housing7)
housing.model15 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + num_bathroom, data = housing7)
summary(housing.model15)
vif(housing.model15)
housing6 = housing6 %>%
mutate(Total_LivArea = GrLivArea + BsmtFinType1 + BsmtFinType2)
housing6 %>%
mutate(BasmtFinSF1 = ifelse(BsmtFinType1 == 'GLQ' | 'ALQ', BsmtFinSF1, 0)) %>%
mutate(BasmtFinSF2 = ifelse(BsmtFinType2 == 'GLQ' | 'ALQ', BsmtFinSF2, 0)) %>%
mutate(BasmtFinSF = BasmtFinSF1 + BasmtFinSF2)
housing6 %>%
mutate(BasmtFinSF1 = ifelse(BsmtFinType1 == 'GLQ' | BsmtFinType1 == 'ALQ', BsmtFinSF1, 0)) %>%
mutate(BasmtFinSF2 = ifelse(BsmtFinType2 == 'GLQ' | BsmtFinType2 =='ALQ', BsmtFinSF2, 0)) %>%
mutate(BasmtFinSF = BasmtFinSF1 + BasmtFinSF2)
housing7 = housing6 %>%
mutate(BasmtFinSF1 = ifelse(BsmtFinType1 == 'GLQ' | BsmtFinType1 == 'ALQ', BsmtFinSF1, 0)) %>%
mutate(BasmtFinSF2 = ifelse(BsmtFinType2 == 'GLQ' | BsmtFinType2 =='ALQ', BsmtFinSF2, 0)) %>%
mutate(BasmtFinSF = BasmtFinSF1 + BasmtFinSF2)
# Do we include Average Rec Room (Rec) as livable area
housing7 = housing6 %>%
mutate(BasmtFinSF1 = ifelse(BsmtFinType1 == 'GLQ' | BsmtFinType1 == 'ALQ', BsmtFinSF1, 0)) %>%
mutate(BasmtFinSF2 = ifelse(BsmtFinType2 == 'GLQ' | BsmtFinType2 =='ALQ', BsmtFinSF2, 0)) %>%
mutate(BasmtFinSF = BasmtFinSF1 + BasmtFinSF2) %>%
mutate(total_LivArea = GrLivArea + BasmtFinSF)
# Model with GrLivArea
housing.model13 = lm(log(SalePrice) ~ log(GrLivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual, data = housing6)
summary(housing.model13)
# Total_LivArea
housing.model15 = lm(log(SalePrice) ~ log(total_LivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + total_LivArea, data = housing7)
summary(housing.model15)
# Total_LivArea
housing.model15 = lm(log(SalePrice) ~ log(total_LivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual, data = housing7)
summary(housing.model15)
housing.model16 = lm(log(SalePrice) ~ log(total_LivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + num_bathroom, data = housing7)
# Do we include Average Rec Room (Rec) as livable area
housing7 = housing6 %>%
mutate(BasmtFinSF1 = ifelse(BsmtFinType1 == 'GLQ' | BsmtFinType1 == 'ALQ', BsmtFinSF1, 0)) %>%
mutate(BasmtFinSF2 = ifelse(BsmtFinType2 == 'GLQ' | BsmtFinType2 =='ALQ', BsmtFinSF2, 0)) %>%
mutate(BasmtFinSF = BasmtFinSF1 + BasmtFinSF2) %>%
mutate(total_LivArea = GrLivArea + BasmtFinSF) %>%
mutate(num_bathroom = BsmtHalfBath2 + HalfBath2 + FullBath + BsmtFullBath)
housing.model16 = lm(log(SalePrice) ~ log(total_LivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + num_bathroom, data = housing7)
summary(housing.model16)
summary(housing.model15)
housing.model16 = lm(log(SalePrice) ~ log(total_LivArea) + log(LotArea) + MasVnrArea2 + log(TotalBsmtSF + 1) + log(GarageArea2 + 1) + YearBuilt + YearRemodAdd + OverallQual + num_bathroom, data = housing7)
summary(housing.model16)
vif(housing.model16)
knitr::opts_chunk$set(echo = TRUE)
str(housing)
